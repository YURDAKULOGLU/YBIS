# Epic 5: Push Notifications & Real-Time Monitoring

**ID:** 5  
**Status:** Draft  
**Owner:** @ybis-team  
**Created:** 2025-10-29  
**Target:** Closed Beta Launch (Week 7)  
**Priority:** P1 (High - User Engagement Critical)

---

## ðŸŽ¯ 1. Epic Goal

Push notification sistemi ve real-time monitoring oluÅŸturmak:
- âœ… EAS Build APK deployment (Expo Go â†’ Production build)
- âœ… Firebase Cloud Messaging (FCM) integration
- âœ… Push notification triggers (task due, flow completion, calendar reminder)
- âœ… OTA updates (EAS Update for quick fixes)
- âœ… Sentry monitoring (error tracking backend + mobile)
- âœ… Performance monitoring (API latency, app startup time)

**Closed Beta Scope:**
- âœ… Firebase FCM setup (google-services.json)
- âœ… EAS Build configuration (eas.json - preview profile for APK)
- âœ… Push token registration (client â†’ backend)
- âœ… Push notification sending (backend â†’ Expo Push API)
- âœ… Basic triggers: Task due reminder, Flow failure notification
- âœ… Sentry integration (error tracking)
- âœ… EAS Update setup (OTA for JS-only changes)
- âŒ Advanced triggers: Calendar reminders, AI suggestions (MVP)

---

## 2. Scope (Kapsam)

### **Push Notifications (P0):**
- âœ… Firebase project setup (YBIS app)
- âœ… FCM configuration (google-services.json)
- âœ… EAS Build (APK for beta distribution)
- âœ… Push token registration flow
- âœ… Expo Push API integration (backend)
- âœ… Push triggers: Task due (1 hour before), Flow execution status
- âœ… Notification UI (foreground + background)

### **OTA Updates (P1):**
- âœ… EAS Update configuration
- âœ… Update channels (beta, production)
- âœ… Automatic update check (on app start)
- âœ… Manual update trigger (user can force update)

### **Monitoring & Observability (P1):**
- âœ… Sentry backend integration (error tracking)
- âœ… Sentry mobile integration (crash reporting)
- âœ… Performance monitoring (API response times, app startup)
- âœ… Health check dashboard (uptime, error rate)

### **NOT in Scope:**
- âŒ Calendar reminders (Epic 6 - Google Calendar)
- âŒ AI-powered notification personalization (Epic 8)
- âŒ In-app notification center (MVP)
- âŒ Notification settings/preferences (MVP)

---

## 3. User Stories (5 Stories - 23 Points)

### **Story 5.1: Firebase & EAS Build Setup (5 points)**
- Firebase project + FCM configuration
- EAS Build APK (preview profile)
- Deep link handling (ybis://auth-callback)

### **Story 5.2: Push Token Registration (3 points)**
- Client: Request permissions + get Expo push token
- Backend: Store tokens in `push_tokens` table
- Token rotation on app start

### **Story 5.3: Push Notification Backend (5 points)**
- Backend endpoint: `/api/push/notify`
- Expo Push API integration
- Batch sending (up to 100 notifications)
- Error handling (invalid tokens, rate limits)

### **Story 5.4: Push Triggers Implementation (5 points)**
- Task due trigger (1 hour before due_date)
- Flow execution status (success/failure)
- Supabase cron job or Edge Function scheduler

### **Story 5.5: Sentry Integration & OTA Updates (5 points)**
- Sentry project setup (backend + mobile)
- Error tracking integration
- Source map upload
- EAS Update configuration
- Update flow (check â†’ download â†’ apply)

---

## 4. Success Metrics

**Technical:**
- âœ… Push delivery success rate >95%
- âœ… Push latency <30s (trigger â†’ delivery)
- âœ… EAS Build success rate 100%
- âœ… OTA update adoption >80% (within 24h)
- âœ… Sentry error capture rate 100% (no missed crashes)

**User:**
- âœ… 70%+ users enable push notifications
- âœ… Push notification engagement rate >50% (tap rate)
- âœ… Zero user complaints about spam

---

**Last Updated:** 2025-10-29  
**Story Points:** 23 (~3-4 hafta)
