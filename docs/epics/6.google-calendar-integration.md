# Epic 6: Google Calendar Integration

**ID:** 6  
**Status:** Draft  
**Owner:** @ybis-team  
**Created:** 2025-10-29  
**Target:** Closed Beta Launch (Week 5-6)  
**Priority:** P0 (Critical - Core Value Proposition)

---

## 🎯 1. Epic Goal

Google Calendar tam entegrasyonu oluşturmak:
- ✅ CalendarPort + GoogleCalendarAdapter
- ✅ OAuth scopes (calendar.events, calendar.settings.readonly)
- ✅ Read upcoming events (30 days)
- ✅ Create events from AI chat
- ✅ Widget integration (Calendar tab - upcoming 3 events)
- ✅ AI calendar analysis (suggest optimal meeting times)
- ✅ Calendar reminders (push notifications)

**Closed Beta Scope:**
- ✅ CalendarPort architecture
- ✅ Google Calendar API v3 integration
- ✅ Read upcoming events (list)
- ✅ Create event (from chat or manual)
- ✅ Calendar widget tab (read-only view)
- ❌ Advanced: Edit/delete events, recurring events (MVP)
- ❌ AI suggestions: Optimal meeting times, schedule analysis (Epic 8)

---

## 2. Scope (Kapsam)

### **Calendar Integration (P0):**
- ✅ CalendarPort interface definition
- ✅ GoogleCalendarAdapter implementation
- ✅ OAuth scopes configuration
- ✅ Token storage (encrypted - Supabase vault)
- ✅ Read upcoming events (next 30 days)
- ✅ Create event (title, start, end, description)

### **Calendar UI (P0):**
- ✅ Calendar screen (upcoming events list)
- ✅ Event detail view (read-only)
- ✅ Add event form (from chat or manual)
- ✅ Widget calendar tab (upcoming 3 events)

### **Calendar Reminders (P1):**
- ✅ Push notification 10 min before event
- ✅ Trigger: Supabase cron job (check every minute)

### **NOT in Scope:**
- ❌ Edit/delete events (MVP)
- ❌ Recurring events support (MVP)
- ❌ Multi-calendar support (MVP)
- ❌ Calendar sync conflicts (MVP)
- ❌ AI schedule optimization (Epic 8)

---

## 3. User Stories (5 Stories - 26 Points)

### **Story 6.1: CalendarPort Architecture (5 points)**
- CalendarPort interface
- GoogleCalendarAdapter implementation
- OAuth scope configuration
- Token exchange (Edge Function)

### **Story 6.2: Read Upcoming Events (5 points)**
- Google Calendar API integration
- Fetch upcoming 30 days events
- Event data mapping (Google → YBIS format)
- Caching strategy (TanStack Query - 5 min TTL)

### **Story 6.3: Create Event API (5 points)**
- Backend endpoint: `/api/calendar/events` (POST)
- Google Calendar API: insert event
- Validation (title, start, end required)
- Error handling (calendar access denied, invalid date)

### **Story 6.4: Calendar UI Screens (6 points)**
- Calendar screen (upcoming events list)
- Event detail view (read-only)
- Add event form (manual input)
- Widget calendar tab (top 3 events)

### **Story 6.5: Calendar Reminders (5 points)**
- Supabase cron: Check events (every minute)
- Trigger: 10 min before event start
- Push notification: "Meeting in 10 minutes: [title]"
- Edge Function: `/api/calendar/reminders`

---

## 4. Success Metrics

**Technical:**
- ✅ Calendar sync success rate >99%
- ✅ Event creation latency <2s
- ✅ Calendar widget load time <1s
- ✅ Reminder accuracy: 100% (no missed reminders)

**User:**
- ✅ 90%+ users connect Google Calendar
- ✅ 60%+ users create events via chat
- ✅ Calendar engagement: 5+ views per day

---

**Last Updated:** 2025-10-29  
**Story Points:** 26 (~4 hafta)
