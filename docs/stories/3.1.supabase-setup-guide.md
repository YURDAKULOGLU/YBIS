# Story 3.1: Supabase Setup - Implementation Guide

**Project:** YBIS  
**Project ID:** friyhdrhkpoztujhhelu  
**Date:** 2025-10-29  
**Status:** IN PROGRESS  

---

## ✅ COMPLETED

- [x] Supabase project created: "YBIS"
- [x] Project ID: friyhdrhkpoztujhhelu

---

## 📋 NEXT STEPS (SEN YAPACAKSIN)

### **STEP 1: Enable Extensions (2 dakika)**

1. Supabase Dashboard'da sol menüden **"Database"** → **"Extensions"** tıkla
2. Aşağıdaki extension'ları aktif et:

```sql
Extensions to Enable:
☐ pgvector (for RAG/embeddings)
☐ pg_cron (for scheduled flows)
☐ uuid-ossp (for UUID generation - usually enabled)
```

**Nasıl yapılır:**
- Extension listesinde ara
- Toggle'ı ON yap
- Kaydet

---

### **STEP 2: Get API Keys (1 dakika)**

1. Sol menüden **"Settings"** → **"API"** tıkla
2. Aşağıdaki değerleri kopyala:

```env
# .env.local file'ına ekle (root dizinde oluştur)

# Supabase Configuration
SUPABASE_URL=https://friyhdrhkpoztujhhelu.supabase.co
SUPABASE_ANON_KEY=<Project API keys → anon public kısmından kopyala>
SUPABASE_SERVICE_ROLE_KEY=<Project API keys → service_role kısmından kopyala>
```

**⚠️ ÖNEMLİ:**
- `service_role` key'i GİZLİ tutmalısın! (Backend'de kullanılır)
- `anon` key public olabilir (Mobile app'de kullanılır)

---

### **STEP 3: Configure Authentication (3 dakika)**

1. Sol menüden **"Authentication"** → **"Providers"** tıkla
2. **Google** provider'ı aktif et:

**Google OAuth Setup:**
```
☐ Google provider'da "Enable Sign in with Google" toggle'ı ON yap
☐ Client ID: (şimdilik boş bırak - daha sonra Google Cloud Console'dan alacağız)
☐ Client Secret: (şimdilik boş bırak)
☐ Authorized redirect URLs: 
   - https://friyhdrhkpoztujhhelu.supabase.co/auth/v1/callback
☐ SAVE
```

**Email/Password Setup:**
```
☐ "Email" provider'da "Enable Email provider" toggle'ı ON yap
☐ "Confirm email" DISABLE et (beta için email confirmation kapalı)
☐ SAVE
```

---

### **STEP 4: Configure Project Settings (1 dakika)**

1. **"Settings"** → **"General"** git
2. Ayarları kontrol et:

```
Project Name: YBIS ✅
Organization: (kendi org'un)
Region: (en yakın region seçilmiş olmalı)
Pause after inactivity: DISABLE (beta için kapalı)
```

---

### **STEP 5: Database URL (1 dakika)**

1. **"Settings"** → **"Database"** git
2. Connection string'i kopyala:

```env
# .env.local'a ekle

DATABASE_URL=postgresql://postgres:[YOUR-PASSWORD]@db.friyhdrhkpoztujhhelu.supabase.co:5432/postgres
```

**⚠️ NOT:** `[YOUR-PASSWORD]` kısmını Supabase'in verdiği şifre ile değiştir!

---

## 📂 CREATE .env.local FILE

Proje root'unda (C:\Projeler\YBIS\) şu dosyayı oluştur:

```bash
# C:\Projeler\YBIS\.env.local

# Supabase Configuration
SUPABASE_URL=https://friyhdrhkpoztujhhelu.supabase.co
SUPABASE_ANON_KEY=<buraya anon key yapıştır>
SUPABASE_SERVICE_ROLE_KEY=<buraya service role key yapıştır>
DATABASE_URL=postgresql://postgres:<ŞİFREN>@db.friyhdrhkpoztujhhelu.supabase.co:5432/postgres

# OpenAI (RAG ve AI için - daha sonra)
OPENAI_API_KEY=<daha sonra eklenecek>

# App Configuration
NODE_ENV=development
```

---

## 🔒 SECURITY: .gitignore Check

`.gitignore` dosyasında şunların olduğundan emin ol:

```bash
# Environment variables
.env
.env.local
.env*.local

# Supabase
supabase/.env
```

---

## ✅ VERIFICATION (Doğrulama)

Hepsini yaptıktan sonra kontrol et:

```bash
# Terminal'de (C:\Projeler\YBIS dizininde)

# 1. .env.local dosyası var mı?
ls .env.local

# 2. İçeriği doğru mu?
cat .env.local
# (SUPABASE_URL, SUPABASE_ANON_KEY görünmeli)

# 3. Extensions aktif mi?
# Supabase Dashboard → Database → Extensions
# pgvector ve pg_cron ENABLED olmalı
```

---

## 📝 STORY 3.1 CHECKLIST

```yaml
Story 3.1: Supabase Project Setup
Status: IN PROGRESS

Tasks:
  ✅ Create Supabase project (DONE)
  ☐ Enable pgvector extension
  ☐ Enable pg_cron extension
  ☐ Get API keys (anon + service_role)
  ☐ Create .env.local file
  ☐ Configure Google OAuth (basic setup)
  ☐ Enable Email/Password auth
  ☐ Disable email confirmation (beta)
  ☐ Verify .gitignore (security)

Estimated: 10 dakika
Actual: TBD

Next Story: 3.2 (Database Schema + RLS)
```

---

## 🆘 SORUN ÇIKARSA?

**Extension bulamıyorsun?**
→ Database → Extensions → Search bar'a "pgvector" yaz

**API key nerede?**
→ Settings → API → Project API keys bölümü

**.env.local nereye?**
→ C:\Projeler\YBIS\.env.local (root dizin)

**Google OAuth şimdi mi gerekli?**
→ Hayır! Basic setup yeterli, detayları daha sonra (Story 3.3'te)

---

## 🎯 BİTİNCE BİLDİR!

Tüm adımları tamamladığında bana **"Story 3.1 done!"** de, 
hemen **Story 3.2'ye** geçelim! (Database Schema oluşturma)

---

**QUESTIONS?** Ask anytime! 🚀
