# Test Data Setup Guide

**File:** `supabase/migrations/004_test_data.sql`  
**Purpose:** Create sample data for testing database schema  
**Date:** 2025-10-29

---

## 📋 PREREQUISITES

**⚠️ IMPORTANT: Create test user FIRST!**

### Step 1: Create Test User (Supabase Dashboard)

1. **Authentication** → **Users**
2. **Add User** (manual)
3. Fill:
   ```
   Email: test@ybis.com
   Password: TestPassword123!
   Auto Confirm User: YES (check this!)
   ```
4. **Create User**

---

## 🚀 RUN TEST DATA

### Step 2: Run SQL Script

1. **SQL Editor** → **New Query**
2. Copy `004_test_data.sql` content
3. **RUN**

---

## ✅ WHAT GETS CREATED

```yaml
Sample Notes (3):
  - "Welcome to YBIS" (favorite)
  - "Project Ideas"
  - "Meeting Notes - Sprint Planning"

Sample Tasks (4):
  - "Complete AuthPort implementation" (high priority, in_progress)
  - "Review PR #42" (medium priority, todo)
  - "Update documentation" (low priority, todo)
  - "Fix Widget height bug" (urgent, done)

Sample Calendar Events (3):
  - "Team Standup" (today 09:00)
  - "Sprint Review" (in 2 days)
  - "Code Review Session" (tomorrow)

Sample Chat Messages (4):
  - User/Assistant conversation about task creation

Sample Flow (1):
  - "My Morning Routine" (scheduled workflow)
```

---

## 🔍 VERIFICATION

Run these queries to check:

```sql
-- Count all data
SELECT 'Notes' as table_name, COUNT(*) as count FROM notes
UNION ALL
SELECT 'Tasks', COUNT(*) FROM tasks
UNION ALL
SELECT 'Calendar Events', COUNT(*) FROM calendar_events
UNION ALL
SELECT 'Chat Messages', COUNT(*) FROM chat_messages
UNION ALL
SELECT 'Flows', COUNT(*) FROM flows;

-- Expected output:
-- Notes: 3
-- Tasks: 4
-- Calendar Events: 3
-- Chat Messages: 4
-- Flows: 1
```

---

## 🆘 TROUBLESHOOTING

**Error: "Test user not found"**
→ Create test@ybis.com user first (Step 1)

**Error: "violates foreign key constraint"**
→ User exists but workspace not auto-created
→ Check if `on_auth_user_created` trigger fired

**Error: "relation calendar_events does not exist"**
→ Run 002_add_calendar_events.sql first
→ Or wait for rate limit to clear

---

## 🎯 NEXT STEPS

After test data is inserted:

1. **Table Editor** → Check tables have data
2. **Test RLS** → Try reading data
3. **Start Story 3.3** → AuthPort implementation

---

**Ready to test!** 🚀
